apiVersion: batch/v1
kind: Job
metadata:
  name: app-back
spec:
  ttlSecondsAfterFinished: 600
  template:
    spec:
      containers:
      - name: app-back
        image: registry.gitlab.com/gezm0/internship_diploma:app_back
        command: ["python",  "app.py"]
        env:
          - name: TF_VAR_db_user
            valueFrom:
              secretKeyRef:
                name: app-secret
                key: db_user
          - name: TF_VAR_db_password
            valueFrom:
              secretKeyRef:
                name: app-secret
                key: db_password
          - name: TF_VAR_db_name
            valueFrom:
              secretKeyRef:
                name: app-secret
                key: db_name
          - name: db_host
            valueFrom:
              configMapKeyRef:
                name: app-configmap
                key: db_host
      restartPolicy: Never
